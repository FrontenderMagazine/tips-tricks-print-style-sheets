# Советы и приемы по подготовке стилей для печати

Большая часть веб-дизайнеров, уделяя все свое внимание пикселям на экране,
продолжает рассматривать стили для печати поверхностно. **На самом деле**,
довольно много людей используют распечатанные страницы сайтов:
есть ещё что-то в том, чтобы держать в руках лист бумаги, даже в этот век
цифрового насыщения.

Чтобы перешагнуть через пропасть между дизайном для печати и дизайном для
экрана, веб-разработчики могут:

* Рассмотреть печать как равноправную часть [адаптивного и отзывчивого веб-дизайна][1].
* Печатать фоновые изображения и цвета в тех случаях, когда это необходимо.
* Добавить в печатную версию текстовые представления адресов ссылок или
возможность отсканировать код ссылки со страницы для простого доступа к
ресурсу.
* Использовать CSS-фильтры для улучшения результатов печати изображений.

## Разрабатывайте дизайн для печати, а не для экрана

Для начала, давайте рассмотрим основы. Современные стили для печати обычно
размещаются внутри медиа-выражения:

    @media print {

    }

Вам не нужно создавать заново весь CSS, потому что стили по умолчанию
будут полностью унаследованы медиа-выражением для печати – необходимо указать
только различия. Большинство браузеров автоматически инвертируют цвета при
печати в целях сохранения тонера, но для получения качественного результата
вам придется **явно указать изменяемые цвета**. В итоге, простейшее
медиа-выражение для печати должно выглядеть вот так:

    @media print {
        body {
            color: #000;
            background: #fff;
        }
    }

В то время, как использование `display: none` было по праву [раскритиковано в отзывчивом дизайне][2],
оно в полной мере допустимо для печатных стилей: в большинстве случаев нашей
целью является не воссоздание скриншота страницы, а предоставление краткой,
хорошо сверстанной ее печатной версии. Затем стоит удалить со страницы все
элементы, которые не нужны в печатной версии, например навигационные панели
и фоновые изображения.

    /* Стили по умолчанию */

    h1 {
        color: #fff;
        background: url(banner.jpg);
    }

    @media print {
        h1 {
            color: #000;
            background: none;
        }

        nav, aside {
            display: none;
        }
    }

Стили для печати — это один из тех немногих случаев, когда вы увидите
использование сантиметров или дюймов в CSS. Совершенно не свойственные для
экранов, системы измерений из реального мира становятся полезными при печати.
Чтобы эффективно использовать лист бумаги при печати, размещайте содержимое на
максимальной площади листа с помощью CSS, избавившись от всех возможных
отступов и полей, управляя полями страницы с помощью правила `@page`:

    @media print {
        h1 {
            color: #000;
            background: none;
        }

        nav, aside {
            display: none;
        }

        body, article {
            width: 100%;
            margin: 0;
            padding: 0;
        }

        @page {
            margin: 2cm;
        }
    }

Для содержимого, к которому пользователь скорее всего захочет оставить
пометки, такого как учебные материалы, поля стоит увеличить.

Также необходимо убедиться, что контент корректно разбивается на страницы.
Во-первых, очевидный шаг, который позволит избежать печати заголовков в самом
низу страницы:

    h2, h3 {
        page-break-after: avoid;
    }

Во-вторых, чтобы предотвратить печать изображений, превышающих по ширине
печатный лист:

    img {
        max-width: 100% !important;
    }

В-третьих, убедимся, что статьи всегда начинаются с новой страницы:

    article {
        page-break-before: always;
    }

Наконец, мы можем предотвратить разрыв больших элементов, таких как
ненумерованные списки и изображения.

    ul, img {
        page-break-inside: avoid;
    }

Несмотря на то, что это не все необходимые правила, это хорошее начало.

## Принудительная печать фоновых изображений и цвета заливки фона

На некоторых сайтах, например портфолио, фоновые изображения и цвет являются
важными визуальными компонентами. Если пользователь печатает страницу из
браузера на основе WebKit (Google Chrome или Safari), мы можем заставить
принтер отобразить цвета так, как мы видим их на экране (то есть заставить
браузер распечатать фоновые изображения и цвета на странице). В общем-то, мы
сделаем это только для цветных принтеров, которые можем определить с помощью
медиа-выражения:

    @media print and (color) {
        * {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }

К сожалению, в настоящее время Firefox, Opera или Internet Explorer не
поддерживают аналогичные свойства.

## Покажите URL внешних ссылок при печати

На сегодняшний день мы (ещё) не можем переходить по ссылкам на печатных
страницах, поэтому URL ссылок необходимо показывать при печати страницы.
Чтобы не захламлять страницу, я предпочитаю показывать в статьях только ссылки
на внешние ресурсы, а внутренние ссылки скрывать. Если вы используете на сайте
относительные URL для внутренних ссылок, вы можете легко сделать это с помощью
селектора по атрибуту и псевдо-элемента `:after`, не допустив печати
внутренних ссылок и ссылок с изображениями внутри:

    @media print {
        article a {
            font-weight: bolder;
            text-decoration: none;
        }

        article a[href^=http]:after {
            content:" <" attr(href) "> ";
        }
    }

Рассмотрим следующий фрагмент HTML:

    <p>Вы уже исследовали этот <a href="/blog">сайт</a>; настало время <a href="http://www.webplatform.org/">прочесть другие статьи о веб-разработке</a>.</p>

Так выглядит распечатанный результат:

![Скиншот][Отображение URL ссылок при печати]

Проблема в том, что якоря и ссылки с изображениями внутри тоже будут
распечатаны. Мы можем запретить печать якорных ссылок с помощью отменяющего
правила:

    article a[href^="#"]:after {
        content: "";
    }

С ссылками, внутри которых лежат изображения, немного сложнее, потому что в
настоящее время CSS не позволяет выбирать элемент по его потомкам. В идеальной
ситуации ссылки с изображениями будут иметь класс, который мы можем
использовать в CSS. В долгосрочной перспективе CSS4 будет предоставлять
селектор по родителю, который сделает за нас всю работу:

    $a:after > img {
        content: "";
    }

С приходом CSS4 показать только внешние ссылки будет значительно проще:

    a:not(:local-link):after {
        content:" <" attr(href) "> ";
    }

Этот подход предполагает, что пользователь будет вводить распечатанный URL
вручную. Лучшим решением будет сделать цифровую версию распечатанной страницы
доступнее, распечатав соответствующего QR-кода.

## Распечатайте QR-коды для упрощения работы со ссылками

При упоминании QR-кодов мы часто видим в них рекламный мусор, однако в
определенных обстоятельствах они могут быть очень полезны. Очевидный пример —
использование в версии для печати QR-кода, который пользователи могут легко
просканировать, чтобы перейти к веб-версии без необходимости вводить URL
вручную.

![Страница с распечатанным QR-кодом, ведущим на веб-версию][Страница с распечатанным QR-кодом, ведущим на веб-версию]

*Страница с распечатанным QR-кодом, ведущим на веб-версию. [Увеличенное изображение][3].*

Для создания соответствующего QR-кода мы используем Google’s Chart
API, который имеет 4 обязательных параметра:

* Тип информации, которую мы хотим получить от Google (в нашем случае это
QR-код);
* Размер получаемого QR-кода в пикселях;
* URL, который необходимо закодировать;
* Используемая кодировка.

Обычно URL стоит привязать к заголовку в верхней части страницы:

    <header>
    <h1>Lizabeth’s Salon</h1>
    <h2>Providing Intellectual Stimulation Online Since 2001</h1>
    </header>

При печати мы оставим поле справа от заголовка h1, и разместим в этой области
QR-код:

    header h1 {
        margin-right: 200px;
        margin-bottom: 2rem;
        line-height: 1.5;
    }

Так как QR-код будет уникальным для каждой страницы, его стоит добавлять прямо
на страницу с помощью элемента `<style>`:

    @media print {
        header h1:after {
            content: url(https://chart.googleapis.com/chart?cht=qr&amp;chs=150x150&amp;chl=http://yourdomain.com&amp;choe=UTF-8);
            position: absolute;
            right: 0;
            top: 0;
        }
    }

У этого приема есть один недостаток, заключающийся в том, что разработчику
необходимо вводить URL каждой страницы для обращения к API для получения кода.
Если ваш сайт работает на PHP, вы можете добавлять URL текущей страницы
автоматически:

    @media print {
        h1:after {
            content: url(https://chart.googleapis.com/chart?cht=qr&amp;chs=150x150&amp;chl=http://<?=$_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];?>&amp;choe=UTF-8);
            position: absolute;
            right: 0;
            top: 0;
        }
    }

Для WordPress:

    @media print {
        h1:after {
            content: url(https://chart.googleapis.com/chart?cht=qr&amp;chs=150x150&amp;chl=http://<?php the_permalink();?>&amp;choe=UTF-8);
            position: absolute;
            right: 0;
            top: 0;
        }
    }

Очевидно, что оба предложенных выше решения будут работать только для страниц
на PHP и WordPress.

## Используйте CSS3-фильтры для улучшения качества печати

При печати логотипов браузеры зачастую испытывают проблемы, особенно, если
светлый логотип расположен на темном фоне страницы:

<table class="layout-table">
   <tbody>
      <tr>
         <th>Изображение логотипа с заливкой</th>
         <th>Распечатанная версия</th>
      </tr>
      <tr>
         <td><a href="img/logo-black-background-300x105.png"><img alt="Логотип на темном фоне" src="img/logo-black-background-300x105.png"></a></td>
         <td><a href="img/logo-black-background-printed-300x80.png"><img alt="Распечатанный логотип на темном фоне" src="img/logo-black-background-printed-300x80.png"></a></td>
      </tr>
      <tr>
         <th>Логотип в виде PNG с альфа-каналом</th>
         <th>Распечатанная версия</th>
      </tr>
      <tr>
         <td><a href="img/logo-black-background-300x105.png"><img alt="Логотип на темном фоне" src="img/logo-black-background-300x105.png"></a></td>
         <td><a href="http:img/logo-transperant-printed-300x87.png"><img alt="Распечатанный логотип на темном фоне с альфаканалом" src="img/logo-transperant-printed-300x87.png"></a></td>
      </tr>
   </tbody>
</table>

Теоретически, вы можете использовать CSS-спрайт для переключения между
версиями логотипа для вывода на экран и для печати, но это означает увеличение
размера файла вдвое при потенциально небольшой выгоде. Вместо этого я
рекомендую использовать CSS-фильтры (и их SVG-эквиваленты в Firefox) для
инвертирования изображения непосредственно при печати:

    @media print {
        header {
           background: none;
            color: #000;
        }

        header img {
            filter: url(inverse.svg#negative);
            -webkit-filter: invert(100%);
            filter: invert(100%);
        }
    }

CSS3-фильтры делают именно то, что вы и ожидаете – инвертируют цвета
изображения в заголовке, делая белое черным, и наоборот – но они работают
только в Chrome и Safari. Для того, чтобы инвертировать изображения в
Firefox, нам необходим другой подход – аналогичный фильтр, записанный в виде
отдельного SVG-файла:

    <svg xmlns="http://www.w3.org/2000/svg">
    <filter id="negative">
    <feColorMatrix values="-1 0 0 0 1
    0 -1 0 0 1
    0 0 -1 0 1
    0 0 0 1 0" />
    </filter>
    </svg>

Принцип работы SVG-фильтра `feColorMatrix` слишком сложен, чтобы раскрывать
его в рамках этой статьи. Подробнее о его работе вы можете прочесть в
статье «[Тонирование веб-страниц с помощью SVG-фильтров и JavaScript][4]»
на Dev.Opera.

Результат печати любого из типов логотипа (PNG с альфа-каналом или логотипа с
заливкой фона) выглядит так:

![Инвертированный логотип при печати][Инвертированный логотип при печати]

## Заключение

Так как использование принтера **не отслеживается ПО для аналитики
сайтов** и, таким образом, не имеет четкой метрики (несмотря на то, что
получение ее возможно, и мы можем обсудить это в последующих статьях), печать
игнорируется многими веб-разработчиками. Их можно понять, ведь большую часть
времени мы просматриваем страницы онлайн. В результате разработчики стремятся
разрабатывать сайты для экранов и устройств, которые они видят перед собой,
забывая о принтерах в другом конце офиса.

С другой стороны, даже если людям только изредка нужно распечатать что-то из
сети, будет правильно, если печатная версия страницы будет адаптирована для
принтеров, так же, как современные сайты адаптируются к разным размерам
экранов и устройствам. Печать должна рассматриваться как ещё один аспект
адаптивного дизайна, юзабилити и доступности, и является такой же важной
частью веб-разработки.

Рассматривая печать как ещё один аспект адаптивного дизайна, мы удовлетворяем
потребности большего количества пользователей сайта, и, в то же время,
сохраняем чернила или тонер, бумагу и другие ресурсы, которые являются важными
аспектами **эко-дизайна**.

### Ссылки для дальнейшего чтения

A List Apart имеет объемный и заслуживающий похвалы архив статей и руководств
по поддержке стилей для печати. Несмотря на то, что многие из материалов
опубликованы достаточно давно, они по-прежнему остаются полезными для тех, кто
готов рассматривать печать как равноценную часть веб-дизайна.

* [CSS-дизайн: подготовка к печати][5], Эрик Мейер (Eric Meyer) (10 мая 2002)
* [Улучшение дизайна ссылок для печати][6], Аарон Густафсон (Aaron Gustafson) (19 сентября 2005)
* [Верстаем книги с помощью CSS3][7], Нелли МакКессон (Nellie McKesson) (12 июня 2012)
* [Как настроить стили для печати][8], Кристиан Краммер (Christian Krammer) (24 ноября 2011)

[1]: http://uxdesign.smashingmagazine.com/2012/11/08/ux-design-qa-with-christian-holst/
[2]: http://laurakalbag.com/display-none/
[3]: img/lizabeth_big-ru.png
[4]: http://dev.opera.com/articles/view/applying-color-tints-to-web-pages-with-s/
[5]: http://www.alistapart.com/articles/goingtoprint/
[6]: http://www.alistapart.com/articles/improvingprint/
[7]: http://www.alistapart.com/articles/building-books-with-css3/
[8]: http://coding.smashingmagazine.com/2011/11/24/how-to-set-up-a-print-style-sheet/

[Отображение URL ссылок при печати]: img/Screen-Shot-2013-01-13-at-8.58.10-PM-ru.png
[Страница с распечатанным QR-кодом, ведущим на веб-версию]: img/lizabeth_big-ru.png
[Инвертированный логотип при печати]: img/logo-inverted-printed-300x91.png
